<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Sales Assistant | D-House Data</title>

  <!-- Favicon (logo in same folder) -->
  <link rel="icon" href="./logo.png" />

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; width: 100%; overflow: hidden; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background: #fff; }

    .topbar {
      height: 44px;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 14px;
      border-bottom: 1px solid #e9ecef;
      background: #ffffff;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 260px;
    }
    .brand img {
      width: 22px;
      height: 22px;
      object-fit: contain;
    }
    .brand .title {
      font-weight: 700;
      font-size: 14px;
      color: #111827;
      white-space: nowrap;
    }
    .brand .sub {
      font-size: 12px;
      color: #6b7280;
      margin-left: 6px;
      white-space: nowrap;
    }

    .spacer { flex: 1; }

    .frame {
      width: 100%;
      height: calc(100% - 44px);
      border: 0;
      display: block;
    }

    .msg {
      padding: 18px;
      color: #111827;
      font-size: 14px;
    }
    .msg h3 { font-size: 16px; margin-bottom: 8px; }
    .msg code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="brand">
      <img src="./logo.png" alt="D-House Data" />
      <div class="title">AI Sales Assistant</div>
      <div class="sub">by D-House Data</div>
    </div>
    <div class="spacer"></div>
  </div>

  <div id="content"></div>

  <script>
    // Apps Script web app exec URL (deployment ID inserted)
    var APPS_SCRIPT_EXEC_URL =
      'https://script.google.com/macros/s/AKfycbxIVRKVqn1fcsmcdXtG0uTk12xrtZpukQ97oIgxOTA1ho9yUOtok7lEntXAZNKSeHTg/exec';

    var query = window.location.search || '';

    // Optional: support token in hash like #token=abc
    if (!query && window.location.hash && window.location.hash.includes('token=')) {
      query = '?' + window.location.hash.replace(/^#/, '');
    }

    var hasToken = query && /(^|[?&])token=/.test(query);
    var content = document.getElementById('content');

    if (!hasToken) {
      content.innerHTML =
        '<div class="msg">' +
          '<h3>Missing token</h3>' +
          '<p>Please open the portal link provided to you. It should look like:</p>' +
          '<p><code>' + window.location.origin + '/?token=YOUR_TOKEN</code></p>' +
        '</div>';
    } else {
      var iframe = document.createElement('iframe');
      iframe.className = 'frame';
      iframe.src = APPS_SCRIPT_EXEC_URL + query;
      iframe.allow = 'forms';
      content.innerHTML = '';
      content.appendChild(iframe);
    }
  </script>
</body>
</html>
