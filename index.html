<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portal: AI Sales Assistant</title>

  <!-- Use logo.png as the tab icon (favicon) -->
  <link rel="icon" href="./logo.png">

  <style>
    * { margin: 0; padding: 0; }
    html, body { height: 100%; overflow: hidden; font-family: -apple-system, sans-serif; }
    iframe { width: 100%; height: 100%; border: none; }
    .loading {
      display: flex; align-items: center; justify-content: center;
      height: 100vh; color: #6c757d; font-size: 1.1rem;
    }
    .missing {
      display: flex; align-items: center; justify-content: center;
      height: 100vh; color: #111827; font-size: 1rem; padding: 24px; text-align: center;
    }
    .missing code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
  </style>
</head>
<body>
  <div class="loading" id="loading">Loading portal...</div>

  <script>
    var params = window.location.search || '';

    // Optional: support token in hash like #token=abc
    if (!params && window.location.hash && window.location.hash.includes('token=')) {
      params = '?' + window.location.hash.replace(/^#/, '');
    }

    var hasToken = params && /(^|[?&])token=/.test(params);

    if (!hasToken) {
      document.body.innerHTML =
        '<div class="missing">' +
          '<div>' +
            '<div><b>Missing token.</b></div>' +
            '<div style="margin-top:10px;color:#6c757d;">Please use the access link provided to you, like:</div>' +
            '<div style="margin-top:8px;"><code>' + window.location.origin + '/?token=YOUR_TOKEN</code></div>' +
          '</div>' +
        '</div>';
    } else {
      var appsScriptUrl = 'https://script.google.com/macros/s/AKfycbxIVRKVqn1fcsmcdXtG0uTk12xrtZpukQ97oIgxOTA1ho9yUOtok7lEntXAZNKSeHTg/exec' + params;

      var iframe = document.createElement('iframe');
      iframe.src = appsScriptUrl;
      iframe.allow = 'forms';
      iframe.onload = function() {
        var el = document.getElementById('loading');
        if (el) el.style.display = 'none';
      };
      document.body.appendChild(iframe);
    }
  </script>
</body>
</html>
